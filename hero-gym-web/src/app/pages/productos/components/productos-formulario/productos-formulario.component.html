<!-- Fondo oscuro -->
<div class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50">
  <!-- Modal -->
  <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-8 relative">
    <!-- Botón cerrar -->
    <button (click)="cerrar()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition">
      ✕
    </button>

    <!-- Título -->
    <h2 class="text-xl font-semibold text-gray-900 mb-2 text-center">
      {{ producto.id ? 'Editar Producto' : 'Registrar Nuevo Producto' }}
    </h2>

    <!-- Error -->
    @if (errorMessage) {
      <div class="mb-4 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md p-3">
        {{ errorMessage }}
      </div>
    }

    <!-- Formulario -->
    <form #productoForm="ngForm" class="space-y-5">
      <!-- Nombre -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Nombre del Producto</label>
        <input
          type="text"
          name="nombre"
          [(ngModel)]="producto.nombre"
          placeholder="Ej: Proteína Whey"
          required
          class="text-black placeholder-gray-400 w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none"
          />
      </div>

      <!-- Precio -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Precio</label>
        <input
          type="number"
          name="precio"
          [(ngModel)]="producto.precio"
          min="0"
          required
          class="text-black placeholder-gray-400 w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none"
          />
      </div>

      <!-- Stock -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Stock Inicial</label>
        <input
          type="number"
          name="stock"
          [(ngModel)]="producto.stock"
          min="0"
          required
          class="text-black placeholder-gray-400 w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none"
          />
      </div>

      <!-- Estado -->
      <div class="border rounded-lg p-3 bg-gray-50 flex items-center justify-between">
        <div>
          <p class="font-medium text-gray-700">Producto Activo</p>
          <p class="text-sm text-gray-500">El producto estará disponible para la venta</p>
        </div>
        <label class="inline-flex items-center cursor-pointer">
          <input type="checkbox" name="estado" class="sr-only peer" [(ngModel)]="producto.estado" />
          <div
            class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300
                   rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px]
                   after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all
                   peer-checked:bg-indigo-600 relative"
          ></div>
        </label>
      </div>

      <!-- Botón guardar -->
      <button
        type="button"
        (click)="guardar()"
        [disabled]="isSubmitting || !productoForm?.valid"
        class="w-full bg-indigo-600 hover:bg-indigo-700 disabled:opacity-60 text-white font-medium py-2.5 rounded-lg shadow-md transition"
        >
        {{ isSubmitting ? 'Guardando...' : (producto.id ? 'Guardar Cambios' : 'Guardar Producto') }}
      </button>
    </form>
  </div>
</div>
